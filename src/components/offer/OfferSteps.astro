---
import { buildImageUrl } from "@lib/directus";
import { Image } from 'astro:assets';
import { getCollection } from "astro:content";
import { marked } from "marked";
import SectionWrapper from "../SectionWrapper.astro";

const [offer] = await getCollection('offer');

---

<SectionWrapper borderBottom={true}>
    <div class="container mx-auto mb px-6 lg:px-8 pb-8">
        <div class="mx-auto max-w-5xl text-center">
            <h2 class="text-xl font-bold tracking-tight sm:text-2xl md:text-4xl xl:text-5xl">{offer.data?.hero_title}</h2>
            <p class="mt-6 text-lg leading-8 text-muted">{offer.data?.hero_message}</p>
        </div>
    </div>
    <div class="flex flex-col gap-20">
        {offer.data?.offer_steps.map((step, index: number) => {
            const content = step.description ? marked.parse(step.description) : undefined;
            const imageLeft = index % 2 === 0;
            return (
                    <div class={`flex flex-col gap-12 ${imageLeft ? "lg:flex-row" : "lg:flex-row-reverse"} items-center`}>
                        <div class="w-full lg:mb-0 lg:w-1/2" style="transform: none;">
                                <div class="relative block overflow-hidden rounded-xl transition-all duration-300">
                                    <div class="absolute inset-0 z-10 bg-black bg-opacity-0 transition-opacity duration-300"
                                         style="opacity: 0;"></div>
                                    <div class="relative w-full overflow-hidden rounded-xl shadow-lg border">
                                        <div class="h-64 w-full bg-gray-500" />
                                    </div>
                                </div>
                        </div>
                        <div class={`lg:w-1/2 ${imageLeft ? "lg:pl-12" : "lg:pr-12"} w-full`}
                             style="opacity: 1; transform: none;">
                            <h3 class="mb-4 text-2xl font-bold">{step.caption}</h3>
                            <div class="mb-6">
                                <div class="prose w-full text-lg dark:prose-invert">
                                    <article set:html={content}/>
                                </div>
                            </div>
                        </div>
                    </div>
            )
        })}
    </div>
    <div class="mx-auto max-w-5xl text-center">
        <h2 class="text-xl font-bold tracking-tight sm:text-xl md:text-2xl xl:text-3xl">{offer.data?.conclusion}</h2>
    </div>
</SectionWrapper>
